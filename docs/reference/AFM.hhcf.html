<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Height-Height Correlation Function for AFM Image — AFM.hhcf • nanoAFMr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Height-Height Correlation Function for AFM Image — AFM.hhcf"><meta property="og:description" content="Computes the height-height correlation function for an AFM data object; note
that any background should be removed first. Since the full computation would 
be lengthy, yet a random subset generally converges to the full result, the
numIterations parameter is used to limit the iterations. It should be 
increased for images with more pixel resolution. With higher resolution, the 
degRes should also be increased. For each iteration a random pixel 
and a random angle with resolution degRes is generated Then, the height-height 
correlation \(g(r) = |h(x) - h(x+r)|^2\) for that point is computed,
where \(r\) stretches from 1 to pixel resolution of the image (scaled by 
r.percentage). Since the AFM image is generally square, some locations / angles 
will not have data for large r and are ignored. Given the random numbers, slightly
different results may be obtained in different runs. To limit the variation, the 
same random numbers can be used, when the randomSeed is populated with a
prime number. It is recommended to run with allResults = TRUE.
The resulting data curve \(g(r)\) is fit to the following equation:
\(2 \sigma^2  (1 - \exp \left[ -(\frac{r}{\xi})^{2H} \right] ) \)

\(\sigma\): roughness
\(\xi\): correlation length
\(H\): Hurst parameter, \(\alpha=2H\)


Publication: http://iopscience.iop.org/article/10.1088/1742-6596/417/1/012069
Title: Height-Height Correlation Function to Determine Grain
       Size in Iron Phthalocyanine Thin Films
Authors: Thomas Gredig, Evan A. Silverstein, Matthew P Byrne
Journal: J of Phys: Conf. Ser. Vol 417, p. 012069 (2013)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">nanoAFMr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/AFM-advancedGraph.html">Advanced AFM Image Graphing</a>
    </li>
    <li>
      <a href="../articles/AFM-graphTypes.html">Plot Graph Types</a>
    </li>
    <li>
      <a href="../articles/AFM-imageSummary.html">AFM Image Summary</a>
    </li>
    <li>
      <a href="../articles/AFM-setPoint.html">Setpoint</a>
    </li>
    <li>
      <a href="../articles/ForceCurves.html">ForceCurves</a>
    </li>
    <li>
      <a href="../articles/FrequencySweep.html">FrequencySweep</a>
    </li>
    <li>
      <a href="../articles/HHCF.html">Height-Height-Correlation-Function</a>
    </li>
    <li>
      <a href="../articles/LineProfiles.html">Line Profiles</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thomasgredig/nanoAFMr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Height-Height Correlation Function for AFM Image</h1>
    <small class="dont-index">Source: <a href="https://github.com/thomasgredig/nanoAFMr/blob/HEAD/R/AFM.hhcf.R" class="external-link"><code>R/AFM.hhcf.R</code></a></small>
    <div class="hidden name"><code>AFM.hhcf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the height-height correlation function for an AFM data object; note
that any background should be removed first. Since the full computation would 
be lengthy, yet a random subset generally converges to the full result, the
<code>numIterations</code> parameter is used to limit the iterations. It should be 
increased for images with more pixel resolution. With higher resolution, the 
<code>degRes</code> should also be increased. For each iteration a random pixel 
and a random angle with resolution <code>degRes</code> is generated Then, the height-height 
correlation \(g(r) = |h(x) - h(x+r)|^2\) for that point is computed,
where \(r\) stretches from 1 to pixel resolution of the image (scaled by 
<code>r.percentage</code>). Since the AFM image is generally square, some locations / angles 
will not have data for large r and are ignored. Given the random numbers, slightly
different results may be obtained in different runs. To limit the variation, the 
same random numbers can be used, when the <code>randomSeed</code> is populated with a
prime number. It is recommended to run with <code>allResults = TRUE</code>.</p>
<p>The resulting data curve \(g(r)\) is fit to the following equation:
\(2 \sigma^2  (1 - \exp \left[ -(\frac{r}{\xi})^{2H} \right] ) \)</p>
<ul><li><p>\(\sigma\): roughness</p></li>
<li><p>\(\xi\): correlation length</p></li>
<li><p>\(H\): Hurst parameter, \(\alpha=2H\)</p></li>
</ul><p>Publication: http://iopscience.iop.org/article/10.1088/1742-6596/417/1/012069
Title: Height-Height Correlation Function to Determine Grain
       Size in Iron Phthalocyanine Thin Films
Authors: Thomas Gredig, Evan A. Silverstein, Matthew P Byrne
Journal: J of Phys: Conf. Ser. Vol 417, p. 012069 (2013).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AFM.hhcf</span><span class="op">(</span></span>
<span>  <span class="va">obj</span>,</span>
<span>  no <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  numIterations <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  addFit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dataOnly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  degRes <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  r.percentage <span class="op">=</span> <span class="fl">80</span>,</span>
<span>  xi.percentage <span class="op">=</span> <span class="fl">70</span>,</span>
<span>  randomSeed <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  allResults <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>obj</dt>
<dd><p>AFMdata object</p></dd>


<dt>no</dt>
<dd><p>channel number</p></dd>


<dt>numIterations</dt>
<dd><p>Number of iterations (must be &gt; 1000), but 10^6 recommended</p></dd>


<dt>addFit</dt>
<dd><p>if <code>TRUE</code> a fit is added to the data</p></dd>


<dt>dataOnly</dt>
<dd><p>if <code>TRUE</code> returns data frame, otherwise returns a graph (OBSOLETE, use allResults)</p></dd>


<dt>degRes</dt>
<dd><p>resolution of angle, the higher the better, should be &gt;100, 1000 is also good, but takes more time</p></dd>


<dt>r.percentage</dt>
<dd><p>a number from 10 to 100 representing the distance to compute, since the image is
square, there are not as many points that are separated by the full length, 80 is a good value, if there
is no fit, the value can be reduced to 70 or 60.</p></dd>


<dt>xi.percentage</dt>
<dd><p>a number from 10 to 100 representing where correlation length could be found from maximum (used for fitting)</p></dd>


<dt>randomSeed</dt>
<dd><p>(optional) a large number, if set, the random numbers are seeded and the results are reproducible</p></dd>


<dt>allResults</dt>
<dd><p>if <code>TRUE</code> returns graph, data and fit parameters as list</p></dd>


<dt>verbose</dt>
<dd><p>output time if <code>TRUE</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>graph, data frame with g(r) and $num indicating number of computations used for r, or
   a list with the graph, data.frame, fit parameters</p>


    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thomas Gredig</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">filename</span> <span class="op">=</span> <span class="fu"><a href="AFM.getSampleImages.html">AFM.getSampleImages</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">'tiff'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="AFM.import.html">AFM.import</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="AFM.flatten.html">AFM.flatten</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">=</span> <span class="fu">AFM.hhcf</span><span class="op">(</span><span class="va">a</span>, numIterations <span class="op">=</span> <span class="fl">5e5</span>, allResults <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>        <span class="co"># output HHCF data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        r.nm          g    num</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  9.803922 0.08437141 498681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 19.607843 0.21569236 496456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 29.411765 0.36541625 494127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 39.215686 0.50120361 491653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 49.019608 0.61608500 489229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 58.823529 0.70302938 486780</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">fitData</span><span class="op">)</span>     <span class="co"># fit data curve data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   r.nm          g</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    9 0.06066597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   10 0.07221660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   11 0.08444162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   12 0.09728038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   13 0.11067460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   14 0.12456816</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">fitParams</span><span class="op">)</span>   <span class="co"># output fit parameters</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       sigma       xi     Hurst    sigma.err    xi.err  Hurst.err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6397166 39.74865 0.8630284 0.0004061273 0.5560641 0.03005544</span>
<span class="r-in"><span><span class="va">r</span><span class="op">$</span><span class="va">graph</span>             <span class="co"># output ggplot2 graph</span></span></span>
<span class="r-plt img"><img src="AFM.hhcf-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thomas Gredig.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

